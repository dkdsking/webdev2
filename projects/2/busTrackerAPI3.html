<!DOCTYPE html>
<html>

<head>
    <title>3 Screen App </title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <link rel="manifest" href="/manifest.json">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: "Roboto", sans-serif;
        }
        @media screen and (max-width: 951px) {
          .raisedMargin {
          margin-bottom: 2%;
          display: block;
          }
        }
        @media screen and (max-width: 420px) {
          .centeredText {
            text-align: center;
          }
          .centeredDiv {
            margin-left: auto;
            margin-right: auto;
            width: 70%;
          }
          .mobileContent {
            text-indent: -9999px;
            line-height: 0; /* Collapse the original line */;
          }
          .mobileContent::after {
            content: "CTA Bus Arrival Times";
            text-indent: 0;
            display: block;
            line-height: initial; /* New content takes up original line height */
          }
        }
        @media screen and (max-width: 320px) {
          .tinyText {
            text-indent: -9999px;
            line-height: 0; /* Collapse the original line */;
          }
          .tinyText::after {
            content: "Western/Addison Bus Tracker";
            text-indent: 0;
            display: block;
            line-height: initial; /* New content takes up original line height */
          }
        }
        #screen1 {
            padding-left: 2%;
            width: 96%;
        }
        
        #screen2 {
            padding-left: 2%;
            width: 96%;
        }
        .boldText {
            font-weight: bold;
        }
        .blueHr {
          background-color:rgb(63,81,181);
          border-top: 3px double rgb(63,81,181)
        }
    </style>
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
</head>

<body>
    <!-- Always shows a header, even in smaller screens. -->
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
        <header class="mdl-layout__header">
            <div class="mdl-layout__header-row">
                <!-- Title -->
                <span class="mdl-layout-title">CTA Bus Tracker</span>
                <!-- Add spacer, to align navigation to the right -->
                <div class="mdl-layout-spacer"></div>
                <!-- Navigation. We hide it in small screens. -->
                <nav class="mdl-navigation mdl-layout--large-screen-only">
                    <a class="mdl-navigation__link" href="#" id="topLink1">Home</a>
                    <a class="mdl-navigation__link" href="#" id="topLink2">Bus Tracker</a>
                </nav>
            </div>
        </header>
        <div class="mdl-layout__drawer">
            <span class="mdl-layout-title">CTA Bus Tracker</span>
            <nav class="mdl-navigation">
                <a id="link1" class="mdl-navigation__link" href="#">Home</a>
                <a id="link2" class="mdl-navigation__link" href="#">Bus Tracker</a>
            </nav>
        </div>
        <main class="mdl-layout__content">
            <div class="screen page-content" id="screen1">
            <h3 class="centeredText tinyText">Western and Addison Bus Tracker</h3>
            <h4>Hey, Lane Tech students! Do you ride a Western or Addison bus to commute? If so, click the "Bus Tracker" link above to get real-time bus arrival predictions for your stop.</h4>
            </div>
            <div class="screen page-content" id="screen2">
                <h3 class="centeredText mobileContent">Get the CTA Bus Arrival Times</h3>
                <h4 >Click a button below to display the bus arrival predictions for that route. 
                <br>Note: These four buttons are for the four Western/Addison intersection stops.</h4>
                <!-- Colored raised button -->
                <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored raisedMargin centeredDiv" id="northBound">
        Northbound 49/X49 Western
      </button>
                <!-- Colored raised button -->
                <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored raisedMargin centeredDiv" id="southBound">
        Southbound 49/X49 Western
      </button>
                <!-- Colored raised button -->
                <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored raisedMargin centeredDiv" id="eastBound">
          Eastbound 152 Addison  
      </button>
                <!-- Colored raised button -->
                <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored raisedMargin centeredDiv" id="westBound">
          Westbound 152 Addison  
      </button>
                <div id="results">
                    
                </div>
            </div>
        </main>
    </div>
    <script>
        $(document).ready(function() {
            $("#screen1").show();
        })
        $("#link1").on("click", function() {
            $(".screen").hide();
            $("#screen1").show();
        })
        $("#topLink1").on("click", function() {
            $(".screen").hide();
            $("#screen1").show();
        })
        $("#link2").on("click", function() {
            $(".screen").hide();
            $("#screen2").show();
        })
        $("#topLink2").on("click", function() {
            $(".screen").hide();
            $("#screen2").show();
        })
        $(function() {
          
          
          var apiPassThruUrl = "https://polar-garden-75406.herokuapp.com/apiPassThru.php";
          
          var apiEndpoint = "http://ctabustracker.com/bustime/api/v2/getroutes";
          
          
          $.ajax({
              url: apiPassThruUrl,
              dataType: "json",
              method: 'GET',
              data: {"apiEndpoint": apiEndpoint,
                      "key" : "YubEefJ33AeRRyxbmYBbgN2QH",
                      "format":"json"}
            }).done (function (data) {
              console.log(data);
              $("#screen1").append("<h4>Routes (for reference)</h4>");
             
              $.each(data["bustime-response"]["routes"], function(i,v) {
                  $("#screen1").append("Route #" + v.rt + ", " + v.rtnm + "<br>");
                
              })

            });
        });
        $("#northBound").click(function() {
          $("#results").empty();
          $(function() {
            
            
            var apiPassThruUrl = "https://polar-garden-75406.herokuapp.com/apiPassThru.php";
            
            var apiEndpoint = "http://www.ctabustracker.com/bustime/api/v2/getpredictions";
            
            $.ajax({
                url: apiPassThruUrl,
                dataType: "json",
                method: 'GET',
                data: {"apiEndpoint": apiEndpoint,
                        "key" : "YubEefJ33AeRRyxbmYBbgN2QH",
                        "format":"json",
                        "stpid": 8417}
              }).done (function (data) {
                //console.log(url);
                console.log(data);
                var resultsHeader = data["bustime-response"]["prd"][0];
                $("#results").append("<h4>Bus Predictions</h4>" + "<p class='boldText'> Stop name: " + resultsHeader.stpnm+"</p>" + 
                "<p class='boldText'>Route direction: " +resultsHeader.rtdir+ "</p>" + "<hr class='blueHr'>");
                $.each (data["bustime-response"]["prd"], function(index,value) {
                    var prediction = value.prdctdn;
                    if (prediction !== "DLY" && prediction !=="DUE" ) {
                      minuteString = " MINUTES";
                      var predictionNum = prediction.toString();
                      var prediction = prediction.concat(minuteString);
                    }
                    if (prediction == "DLY") {
                      var prediction = "DELAYED";
                    }
                    var delayIf = value.dly;
                    if (delayIf == true) {
                      var delayIf = "Yes"
                    } else {
                      var delayIf = "No"
                    }
                    var html ="<h6 class='boldText'>"+"Bus Arrival Time: " +prediction  +"<h6>"+
                    "<p class='boldText'>Bus Type: " +value.rtdd +"</p>"+"<hr>";
                    $("#results").append(html);
                })
    
                if ($('#results').contents().length == 0) {
                      $("#results").append("Sorry, no information was found for that stop ID. Click the link above if you want to look through the valid IDs.")
                }
  
              });
          });
        });
        $("#southBound").click(function() {
          $("#results").empty();
          $(function() {
            
            
            var apiPassThruUrl = "https://polar-garden-75406.herokuapp.com/apiPassThru.php";
            
            var apiEndpoint = "http://www.ctabustracker.com/bustime/api/v2/getpredictions";
            
            $.ajax({
                url: apiPassThruUrl,
                dataType: "json",
                method: 'GET',
                data: {"apiEndpoint": apiEndpoint,
                        "key" : "YubEefJ33AeRRyxbmYBbgN2QH",
                        "format":"json",
                        "stpid": 8195}
              }).done (function (data) {
                //console.log(url);
                console.log(data);
                var resultsHeader = data["bustime-response"]["prd"][0];
                $("#results").append("<h4>Bus Predictions</h4>" + "<p class='boldText'> Stop name: " + resultsHeader.stpnm+"</p>" + 
                "<p class='boldText'>Route direction: " +resultsHeader.rtdir+ "</p>" + "<hr class='blueHr'>");
                $.each (data["bustime-response"]["prd"], function(index,value) {
                    var prediction = value.prdctdn;
                    if (prediction !== "DLY" && prediction !=="DUE" ) {
                      minuteString = " MINUTES";
                      var predictionNum = prediction.toString();
                      var prediction = prediction.concat(minuteString);
                    }
                    if (prediction == "DLY") {
                      var prediction = "DELAYED";
                    }
                    var delayIf = value.dly;
                    if (delayIf == true) {
                      var delayIf = "Yes"
                    } else {
                      var delayIf = "No"
                    }
                    var html ="<h6 class='boldText'>"+"Bus Arrival Time: " +prediction  +"<h6>"+
                    "<p class='boldText'>Bus Type: " +value.rtdd +"</p>"+"<hr>";
                    $("#results").append(html);
                })
    
                if ($('#results').contents().length == 0) {
                      $("#results").append("Sorry, no information was found for that stop ID. Click the link above if you want to look through the valid IDs.")
                }
  
              });
          });
        });
        $("#eastBound").click(function() {
          $("#results").empty();
          $(function() {
            
            
            var apiPassThruUrl = "https://polar-garden-75406.herokuapp.com/apiPassThru.php";
            
            var apiEndpoint = "http://www.ctabustracker.com/bustime/api/v2/getpredictions";
            
            $.ajax({
                url: apiPassThruUrl,
                dataType: "json",
                method: 'GET',
                data: {"apiEndpoint": apiEndpoint,
                        "key" : "YubEefJ33AeRRyxbmYBbgN2QH",
                        "format":"json",
                        "stpid": 12527}
              }).done (function (data) {
                //console.log(url);
                console.log(data);
                var resultsHeader = data["bustime-response"]["prd"][0];
                $("#results").append("<h4>Bus Predictions</h4>" + "<p class='boldText'> Stop name: " + resultsHeader.stpnm+"</p>" + 
                "<p class='boldText'>Route direction: " +resultsHeader.rtdir+ "</p>" + "<hr class='blueHr'>");
                $.each (data["bustime-response"]["prd"], function(index,value) {
                    var prediction = value.prdctdn;
                    if (prediction !== "DLY" && prediction !=="DUE" ) {
                      minuteString = " MINUTES";
                      var predictionNum = prediction.toString();
                      var prediction = prediction.concat(minuteString);
                    }
                    if (prediction == "DLY") {
                      var prediction = "DELAYED";
                    }
                    var delayIf = value.dly;
                    if (delayIf == true) {
                      var delayIf = "Yes"
                    } else {
                      var delayIf = "No"
                    }
                    var html ="<h6 class='boldText'>"+"Bus Arrival Time: " +prediction  +"<h6>"+
                    "<hr>";
                    $("#results").append(html);
                })
    
                if ($('#results').contents().length == 0) {
                      $("#results").append("Sorry, no information was found for that stop ID. Click the link above if you want to look through the valid IDs.")
                }
  
              });
          });
        });
        $("#westBound").click(function() {
          $("#results").empty();
          $(function() {
            
            
            var apiPassThruUrl = "https://polar-garden-75406.herokuapp.com/apiPassThru.php";
            
            var apiEndpoint = "http://www.ctabustracker.com/bustime/api/v2/getpredictions";
            
            $.ajax({
                url: apiPassThruUrl,
                dataType: "json",
                method: 'GET',
                data: {"apiEndpoint": apiEndpoint,
                        "key" : "YubEefJ33AeRRyxbmYBbgN2QH",
                        "format":"json",
                        "stpid": 12569}
              }).done (function (data) {
                //console.log(url);
                console.log(data);
                var resultsHeader = data["bustime-response"]["prd"][0];
                $("#results").append("<h4>Bus Predictions</h4>" + "<p class='boldText'> Stop name: " + resultsHeader.stpnm+"</p>" + 
                "<p class='boldText'>Route direction: " +resultsHeader.rtdir+ "</p>" + "<hr class='blueHr'>");
                $.each (data["bustime-response"]["prd"], function(index,value) {
                    var prediction = value.prdctdn;
                    if (prediction !== "DLY" && prediction !=="DUE" ) {
                      minuteString = " MINUTES";
                      var predictionNum = prediction.toString();
                      var prediction = prediction.concat(minuteString);
                    }
                    if (prediction == "DLY") {
                      var prediction = "DELAYED";
                    }
                    var delayIf = value.dly;
                    if (delayIf == true) {
                      var delayIf = "Yes"
                    } else {
                      var delayIf = "No"
                    }
                    var html ="<h6 class='boldText'>"+"Bus Arrival Time: " +prediction  +"<h6>"+
                    "<hr>";
                    $("#results").append(html);
                })
    
                if ($('#results').contents().length == 0) {
                      $("#results").append("Sorry, no information was found for that stop ID. Click the link above if you want to look through the valid IDs.")
                }
  
              });
          });
        });
    </script>
</body>

</html>
